<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta charset="utf-8">
<!--字体图标-->
<link href="../../javaex/pc/css/icomoon.css" rel="stylesheet" />
<!--动画-->
<link href="../../javaex/pc/css/animate.css" rel="stylesheet" />
<!--骨架样式-->
<link href="../../javaex/pc/css/common.css" rel="stylesheet" />
<!--皮肤（缇娜）-->
<link href="../../javaex/pc/css/skin/tina.css" rel="stylesheet" />
<!--jquery，不可修改版本-->
<script src="../../javaex/pc/lib/jquery-1.7.2.min.js"></script>
<!--全局动态修改-->
<script src="../../javaex/pc/js/common.js"></script>
<!--核心组件-->
<script src="../../javaex/pc/js/javaex.min.js"></script>
<!--表单验证-->
<script src="../../javaex/pc/js/javaex-formVerify.js"></script>
<title>图书馆</title>
</head>
<style>
    
</style>

<body>
    <!--全部主体内容-->
<div class="list-content">
	<!--块元素-->
	<div class="block">
		<!--修饰块元素名称-->
		<div class="banner">
			<p class="tab fixed">留言板</p>
		</div>
	
		<!--正文内容-->
		<div>
			<br>
			<div class="text-area">
				<textarea id="umsg" cols="180" rows="10" ></textarea>
			</div>

			<div class="button;text-align:center" >

				<input type="button" id="save" class="button yes" value="保存" />
				<input type="button" id="return" class="button no" value="清空" />

			</div>
		</div>
	</div>
</div>
	<script type="text/javascript">


        javaex.date({
            id : "time",	// 承载日期组件的id
            isTime : true,
            date : "2021-02-15 01:01:01",	// 选择的日期
            // 重新选择日期之后返回一个时间对象
            callback : function(rtn) {
            }
        });

        // 监听点击保存按钮事件
        $("#save").click(function() {
            // 获取输入内容
            var umsg = $("#umsg").val();

            var myDate=new Date();
            //var time = myDate.getFullYear()+"-"+myDate.getMonth()+"-"+myDate.getDate()+" "myDate.getHours()+":"+myDate.getMinutes()+":"+myDate.getSeconds();
			var time = myDate;
            // 校验文本
            if (umsg == "") {
                javaex.optTip({
                    content : "留言不能为空!",
                    type : "error"
                });

                return false;
            }


            // 数据
            var json = {"umsg":umsg,"time":time};

            // 提交
            // ajax 示例
            $.ajax({
                //请求方式
                type : "POST",
                //请求的媒体类型
                contentType: "application/json;charset=UTF-8",
                //请求地址
                url : "msg",
                //数据，json字符串
                data : JSON.stringify(json),
                //请求成功
                success : function(result) {
                    console.log(result);
                    // 获取集合属性
                    var data = result.data;
                    var code = result.code;

                    if (code == 200) {
                        javaex.message({
                            content : "添加成功",
                            type : "success"
                        });
                        // 跳转至列表
                        setTimeout(function(){ window.location.href="/user/user-msg";},1500)
                    }

                },
                //请求失败，包含具体的错误信息
                error : function(e){
                    console.log(e.status);
                    console.log(e.responseText);
                }
            });

        });

        // 监听点击返回按钮事件
        $("#return").click(function() {
            window.location.href = "/user/user-msg";
        });
	</script>
</body>
</html>